Model thong_test_pop {
  type: 'query'
  label: 'Thong Test Pop'
  description: ''
  data_source_name: 'demo_bigquery'
  dimension month {
    label: 'Month'
    type: 'date'
    hidden: false
    definition: @sql {{ #SOURCE.month }};;
  }
  dimension total_sales {
    label: 'Total Sales'
    type: 'number'
    hidden: false
    definition: @sql {{ #SOURCE.total_sales }};;
  }

  owner: 'thong.do@holistics.io'
  query: @sql
    WITH months AS (
      SELECT
        month_date,
        OFFSET AS idx
      FROM UNNEST(
        GENERATE_DATE_ARRAY(DATE '2025-09-01', DATE '2027-08-01', INTERVAL 1 MONTH)
      ) AS month_date WITH OFFSET
    )
    SELECT
      month_date AS month,  -- stays as DATE type
      CASE
        WHEN MOD(idx, 5) = 0 THEN NULL
        ELSE 5000 + idx * 1000
      END AS total_sales
    FROM months
    ORDER BY month_date;;;
  models: [
  ]
}
