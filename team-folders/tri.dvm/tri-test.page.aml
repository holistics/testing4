Dashboard tri_test {
  title: 'Tri Test'
  description: ''''''

  view: CanvasLayout {
    label: 'View 1'
    height: 4340
    grid_size: 20
    mobile {
      mode: 'auto'
    }
    block v1 {
      position: pos(100, 20, 400, 300)
      layer: 2
    }
    block f1 {
      position: pos(520, 20, 300, 100)
      layer: 3
    }
    block v2 {
      position: pos(820, 20, 400, 300)
      layer: 4
    }
    block f2 {
      position: pos(720, 500, 300, 100)
      layer: 5
    }
    block f3 {
      position: pos(880, 460, 300, 100)
      layer: 6
    }
    block v3 {
      position: pos(480, 640, 680, 2500)
      layer: 7
    }
    block v4 {
      position: pos(40, 640, 400, 300)
      layer: 8
    }
    block f4 {
      position: pos(460, 260, 340, 100)
      layer: 9
    }
    block v_txfg {
      position: pos(40, 420, 260, 180)
      layer: 10
    }
    block f_78ij {
      position: pos(80, 320, 300, 80)
      layer: 11
    }
    block p_io6h {
      position: pos(340, 440, 300, 140)
      layer: 12
    }
    width: 1320
  }

  theme: H.themes.classic.extend(
    {
      custom_css: @css 
     .ci-download-tab-xlsx, .ci-download-excel {
      display:none;
     }
     #block-v1 {
      display:none;
     }
    ;;
    }
  )
  block v1: VizBlock {
    label: 'CLV'
    viz: DataTable {
      dataset: demo_ecommerce
      fields: [
        VizFieldFull {
          ref: ref('order_master', 'order_id')
          format {
            type: 'number'
            pattern: 'inherited'
          }
        },
        VizFieldFull {
          ref: ref('order_master', 'user_id')
          format {
            type: 'number'
            pattern: 'inherited'
          }
        },
        VizFieldFull {
          ref: ref('order_master', 'amount')
          format {
            type: 'number'
            pattern: 'inherited'
          }
        },
        VizFieldFull {
          ref: ref('order_master', 'customer_lifetime_value')
          format {
            type: 'number'
            pattern: 'inherited'
          }
        }
      ]
      settings {
        show_row_number: true
        row_limit: 5000
        aggregate_awareness {
          enabled: true
          debug_comments: true
        }
      }
    }
  }
  block f1: FilterBlock {
    label: 'aaaa'
    type: 'field'
    source: FieldFilterSource {
      dataset: demo_ecommerce
      field: ref('order_master', 'status')
    }
    default {
      operator: 'is'
      value: 'delivered'
    }
  }
  block v2: VizBlock {
    label: 'vggg'
    viz: DataTable {
      dataset: demo_ecommerce_metrics
      fields: [
        VizFieldFull {
          ref: ref('order_master', 'order_id')
          format {
            type: 'number'
            pattern: 'inherited'
          }
        },
        VizFieldFull {
          ref: ref('order_master', 'user_id')
          format {
            type: 'number'
            pattern: 'inherited'
          }
        },
        VizFieldFull {
          ref: ref('order_master', 'amount')
          format {
            type: 'number'
            pattern: 'inherited'
          }
        },
        VizFieldFull {
          ref: ref('order_master', 'clv_dimensionalized')
          format {
            type: 'number'
            pattern: 'inherited'
          }
        }
      ]
      settings {
        show_row_number: true
        row_limit: 5000
        aggregate_awareness {
          enabled: true
          debug_comments: true
        }
      }
    }
  }
  block f2: FilterBlock {
    label: 'CLV Filter'
    type: 'field'
    source: FieldFilterSource {
      dataset: demo_ecommerce_metrics
      field: ref('order_master', 'clv_dimensionalized')
    }
    default {
      operator: 'is'
      value: []
    }
  }
  block f3: FilterBlock {
    label: 'CVN'
    type: 'field'
    source: FieldFilterSource {
      dataset: demo_ecommerce_metrics
      field: ref('order_master', 'customer_lifetime_value')
    }
    default {
      operator: 'is'
      value: []
    }
  }
  block v3: VizBlock {
    label: 'Test 1'
    viz: DataTable {
      dataset: buyers_sellers_transactions
      calculation metric_cdab8ae {
        label: 'Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label'
        formula: @aql 1;;
        calc_type: 'measure'
        data_type: 'number'
      }
      calculation metric_e620fbb {
        label: 'Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label Long long label '
        formula: @aql 1;;
        calc_type: 'measure'
        data_type: 'number'
      }
      fields: [
        VizFieldFull {
          label: 'Full Name (Team Lead)'
          ref: ref('buyers', 'full_name')
          format {
            type: 'text'
          }
        },
        VizFieldFull {
          label: 'Metric'
          ref: ref('transactions_buyers_sellers', 'quantity')
          aggregation: 'sum'
          format {
            type: 'number'
            pattern: 'inherited'
          }
        },
        VizFieldFull {
          label: 'Full Name (Supervisor)'
          ref: ref('sellers', 'full_name')
          format {
            type: 'text'
          }
        },
        VizFieldFull {
          ref: 'metric_cdab8ae'
          format {
            type: 'number'
            pattern: 'inherited'
          }
        },
        VizFieldFull {
          ref: 'metric_e620fbb'
          format {
            type: 'number'
            pattern: 'inherited'
          }
        }
      ]
      settings {
        wrap_header_text: true
        show_row_number: true
        sorts: [
          SortSetting {
            field_index: 0
            direction: 'asc'
          },
          SortSetting {
            field_index: 2
            direction: 'asc'
          }
        ]
        row_limit: 5000
        aggregate_awareness {
          enabled: true
          debug_comments: true
        }
        frozen_columns: 0
      }
    }
  }
  block v4: VizBlock {
    label: 'Untitled Report'
    viz: DataTable {
      dataset: ecom_dataset_vux
      theme {
        table {
          general {
            borders {
              outer: true
              horizontal: true
            }
          }
        }
      }
      fields: [
        VizFieldFull {
          ref: r(ecom_dataset_vux.total_orders)
          format {
            type: 'number'
            pattern: 'inherited'
          }
          uname: 'custom_total_orders'
        },
        VizFieldFull {
          ref: r(order_master.order_id)
          format {
            type: 'number'
            pattern: 'inherited'
          }
        }
      ]
      settings {
        show_row_number: true
        conditional_formats: [
          ConditionalFormat {
            key: 'custom_total_orders'
            format: SingleFormat {
              condition {
                operator: 'is'
                value: 102
              }
              text_color: '#328159'
              background_color: '#B5E3CD'
              apply_to_row: true
            }
          }
        ]
        row_limit: 5000
        aggregate_awareness {
          enabled: true
          debug_comments: true
        }
        column_styles: [
          ColumnStyle {
            key: '_holistics_row_number_'
            width: 198
          }
        ]
      }
    }
  }
  block f4: FilterBlock {
    label: 'Transactions Transaction Date'
    type: 'field'
    source: FieldFilterSource {
      dataset: buyers_sellers_transactions
      field: ref('transactions_buyers_sellers', 'transaction_date')
    }
    default {
      operator: 'matches'
      value: '$H_NIL$'
    }
  }
  block v_txfg: VizBlock {
    label: '  (Prev. 2y)'
    viz: MetricKpi {
      dataset: demo_ecommerce
      calculation metric_c4c4dff {
        label: 'Untitled Metric'
        formula: @aql count(order_master.order_id);;
        calc_type: 'measure'
        data_type: 'number'
      }
      calculation metric_0b33d48 {
        label: 'Untitled Metric'
        formula: @aql concat('aaaa', cast(total_orders, 'text'));;
        calc_type: 'measure'
        data_type: 'text'
      }
      filter {
        field: r(order_master.order_created_at)
        operator: 'matches'
        value: '2 years ago'
      }
      value: VizFieldFull {
        label: ' '
        ref: 'metric_0b33d48'
        format {
          type: 'text'
        }
      }
      compare_value: VizPopSettings {
        field: r(order_master.order_created_at)
        duration: 2
        granularity: 'year'
      }
      settings {
        display_mode: 'single'
        aggregate_awareness {
          enabled: true
          debug_comments: true
        }
        alignment: 'left'
      }
    }
    settings {
      hide_label: true
    }
  }
  block f_78ij: FilterBlock {
    label: 'Order Master Order Created At'
    type: 'field'
    source: FieldFilterSource {
      dataset: demo_ecommerce
      field: r(order_master.order_created_at)
    }
    default {
      operator: 'matches'
      value: '$H_NIL$'
    }
  }
  block p_io6h: PopBlock {
    label: 'Period Comparison'
    default {
      type: 'relative'
      duration: 1
      granularity: 'year'
    }
  }
  interactions: [
    FilterInteraction {
      from: 'f1'
      to: [
        CustomMapping {
          block: 'f_78ij'
          disabled: true
        }
      ]
    },
    FilterInteraction {
      from: 'f2'
      to: [
        CustomMapping {
          block: 'f3'
          disabled: true
        }
      ]
    },
    FilterInteraction {
      from: 'f3'
      to: [
        CustomMapping {
          block: 'f2'
          disabled: true
        }
      ]
    },
    FilterInteraction {
      from: 'f_78ij'
      to: [
        CustomMapping {
          block: 'f1'
          disabled: true
        }
      ]
    },
    PopInteraction {
      from: 'p_io6h'
      to: [
        CustomMapping {
          block: 'v_txfg'
          field: ref('order_master', 'order_created_at')
        }
      ]
    }
  ]
}