Dataset test_num {
  label: 'Test Num'
  description: ''
  data_source_name: 'demodb'
  models: [
    test_1
  ]
  relationships: [
  ]
  owner: 'vu.dq@holistics.io'
  metric format {
    label: "Format"
    type: "text"
    hidden: false
    description: ""
    definition: @aql case(
    when: test_1.num >= 1000000
  , then: 
      concat(
        cast(div(test_1.num, 1000000), 'text'), '.',
        cast(div(mod(test_1.num, 1000000), 100000), 'text'),
        cast(div(mod(test_1.num, 100000), 10000), 'text'),
        cast(div(mod(test_1.num, 10000), 1000), 'text'),
        'M'
      )
  , when: test_1.num >= 1000
  , then: 
      concat(
        cast(div(test_1.num, 1000), 'text'), '.',
        cast(div(mod(test_1.num, 1000), 100), 'text'),
        cast(div(mod(test_1.num, 100), 10), 'text'),
        cast(div(mod(test_1.num, 10), 1), 'text'),
        'K'
      )
  , else: cast(test_1.num, 'text')
);;
  }
}